<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>One of the key component for transformers are <b>positional embeddings</b>.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/positional_encoding-480.webp 480w,/assets/img/positional_encoding-800.webp 800w,/assets/img/positional_encoding-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/positional_encoding.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Transformer by design does not take into account the order of the tokens. Attention mechanism treats a sequence as a bag of tokens. The processing of the embedding vectors in the transformer attention block to transform into query, key and value vector occurs in parallel. Therefore, the information about the order is not captured. For this reason, positional embeddings are important to take account for the order of tokens; ex. consider : <strong>The man attacked the tiger</strong> vs <strong>The tiger attacked the man</strong>.</p> <p>Position embeddings are a unique embedding generated for each position in the sequence. These are dense vectors representing the position of each token in the sequence. The token embedding (dense vector representation of each token in input sequence capturing the semantic meaning of the token) and the positional embeddings (offset vector) are combined to result in a new vector that contains both semantic and position information.</p> <p>The positional embeddings value cannot be too large. If the positional embeddings (which are offset vectors) are too lartge, then the combined vector will get offset by a very large distance destroying the overall concept of the embedding space where word vector closely related are close to one another. Therefore, the mathematical function to model the positional embeddings should be bounded like sine / cosine (value between -1 and +1).</p> <p><strong>Attention is all you need</strong> paper defined positional embedding as a combination of sine and cosine functions of the position in input sequence and dimension of the output embedding space.</p> <p>RoPE was first introduced in 2022 RoFormer paper https://arxiv.org/pdf/2104.09864.</p> <p>The goal for position encoding is to enable supervision for dependency modeling between elements at different positions of the sequence.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/RoPE-480.webp 480w,/assets/img/RoPE-800.webp 800w,/assets/img/RoPE-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/RoPE.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>RoPE encodes the absolute position with a rotation matrix and meanwhile incorporates the explicit relative position dependency in self attention formulation.</p> <ul> <li>Flexibility of sequence length</li> <li>Decaying inter-token dependency with increasing relative distances</li> <li>Capability if equipping the linear self-attention with relative position encoding.</li> </ul> </body></html>